# ğŸš€ RADS v0.0.8 Development Plan

**Codename:** `SUPERNOVA` ğŸ’¥
**Theme:** Explosion of Features, Complete Core, Production Power
**Target Release:** ~8 weeks from now
**Status:** Ready to Implement

---

## ğŸ¯ Vision

v0.0.8 "SUPERNOVA" focuses on **completing what was started** and **fixing what's broken**. Rather than adding more half-baked features, we:

1. **Finish all stubs** - Complete the 85+ TODO items
2. **Fix all bugs** - Arrays, type inference, return values
3. **Polish to production** - Make everything work 100%

---

## ğŸ“Š Current State Analysis (v0.0.7)

### What's Working âœ…
| Feature | Status | Notes |
|---------|--------|-------|
| Lexer | âœ… 100% | Tokenizes all syntax correctly |
| Parser | âœ… 95% | Parses most constructs |
| REPL | âœ… 100% | RGB colors, history, commands |
| Functions | âœ… 90% | Basic calls work |
| Control Flow | âœ… 100% | if/else, loop, cruise |
| Structs | âœ… 95% | Definition and access work |
| Build System | âœ… 95% | Compiles cleanly |
| Arithmetic | âœ… 100% | All operators work |
| String concat | âœ… 100% | `+` operator works |

### What's Broken ğŸ”´
| Bug | Severity | Location | Impact |
|-----|----------|----------|--------|
| Arrays print as `null` | ğŸ”´ CRITICAL | interpreter.c | Can't see array contents |
| Array operations return `null` | ğŸ”´ CRITICAL | stdlib_array.c | map, filter, etc. broken |
| Function return values lost | ğŸŸ¡ HIGH | interpreter.c | Nested returns fail |
| Type inference returns `null` | ğŸŸ¡ HIGH | typecheck.c | typeof broken |
| stdlib functions are stubs | ğŸŸ¡ HIGH | 85+ TODOs | Many features incomplete |

### What's Incomplete (Stubs Count)
| Module | Stub Count | Priority | Functions |
|--------|------------|----------|-----------|
| `stdlib_array.c` | 8 | ğŸ”´ P0 | map, filter, reduce, find, some, every, sort, reverse |
| `stdlib_string_advanced.c` | 7 | ğŸ”´ P0 | split, join, trim, upper, lower, replace, substring |
| `stdlib_math_extended.c` | 7 | ğŸŸ¡ P1 | min, max, clamp, floor, ceil, round, random |
| `stdlib_filesystem.c` | 3 | ğŸŸ¡ P1 | readdir, stat, unlink |
| `stdlib_async_utils.c` | 4 | ğŸŸ¢ P2 | parallel, series, retry, timeout |
| `jit/jit.c` | 6 | ğŸŸ¢ P3 | LLVM integration stubs |
| `gc/generational.c` | 4 | ğŸŸ¢ P3 | Generational GC stubs |
| `typecheck/typecheck.c` | 5 | ğŸŸ¡ P1 | Type inference stubs |
| `debug/conditional_breakpoints.c` | 4 | ğŸŸ¢ P2 | Step into/over/out |
| `runtime/runtime.c` | 2 | ğŸŸ¢ P2 | Error throwing |
| `test/test_discovery.c` | 3 | ğŸŸ¢ P3 | Test execution |

**Total Stubs: 53+ (core modules)**

---

## ğŸ”¥ PRIORITY 0: Critical Bug Fixes (Week 1)

### 0.1 Fix Array System ğŸ”´
**Problem:** Arrays print as `null`, array operations don't work

**Symptoms:**
```rads
turbo arr = [1, 2, 3, 4, 5];
echo(arr);  // Prints: null (should be: [1, 2, 3, 4, 5])
echo(length(arr));  // Prints: null (should be: 5)
```

**Root Cause:**
- Array literal creation returns null
- Array operations are unimplemented stubs

**Fix Plan:**
1. Fix `make_array_from_list()` in interpreter.c
2. Implement all 8 array operations in `stdlib_array.c`
3. Ensure `length()` builtin works with arrays

**Files to Modify:**
- `src/core/interpreter.c`
- `src/stdlib/stdlib_array.c`
- `src/core/ast.c` (if needed)

**Target Behavior:**
```rads
turbo arr = [1, 2, 3, 4, 5];
echo(arr);                        // [1, 2, 3, 4, 5]
echo(length(arr));                // 5
echo(arr[0]);                     // 1
arr.push(6);                      // Add 6
echo(arr);                        // [1, 2, 3, 4, 5, 6]
```

### 0.2 Fix Function Return Values ğŸŸ¡
**Problem:** `return x + y;` in nested functions loses the value

**Symptoms:**
```rads
blast add(a, b) {
    return a + b;
}
turbo result = add(5, 3);
echo(result);  // May print: null (should be: 8)
```

**Fix Plan:**
1. Audit `exec_statement()` for `AST_RETURN_STMT`
2. Ensure return values propagate through call stack
3. Handle early returns in blocks properly

**Files to Modify:**
- `src/core/interpreter.c`

### 0.3 Fix Type Inference ğŸŸ¡
**Problem:** `typeof arr` returns incorrect type

**Symptoms:**
```rads
turbo x = 42;
echo(typeof x);  // Prints: null (should be: integer)
```

**Fix Plan:**
1. Implement `ast_create_typeof()` evaluation
2. Return proper type strings
3. Handle all value types

**Files to Modify:**
- `src/core/interpreter.c`
- `src/typecheck/typecheck.c`

---

## â­ PRIORITY 1: Complete Standard Library (Week 2-3)

### 1.1 Array Operations (8 functions)

**File:** `src/stdlib/stdlib_array.c`

```rads
// All functions to implement:

// 1. map - Transform each element
turbo doubled = array.map([1, 2, 3], blast(x) { return x * 2; });
// Result: [2, 4, 6]

// 2. filter - Keep elements that pass test
turbo evens = array.filter([1, 2, 3, 4], blast(x) { return x % 2 == 0; });
// Result: [2, 4]

// 3. reduce - Reduce to single value
turbo sum = array.reduce([1, 2, 3, 4], blast(acc, x) { return acc + x; }, 0);
// Result: 10

// 4. find - Find first matching element
turbo found = array.find([1, 2, 3, 4], blast(x) { return x > 2; });
// Result: 3

// 5. some - Check if any element matches
turbo hasEven = array.some([1, 3, 5], blast(x) { return x % 2 == 0; });
// Result: false

// 6. every - Check if all elements match
turbo allPositive = array.every([1, 2, 3], blast(x) { return x > 0; });
// Result: true

// 7. sort - Sort array in place
turbo arr = [3, 1, 4, 1, 5];
array.sort(arr);
// Result: [1, 1, 3, 4, 5]

// 8. reverse - Reverse array in place
turbo arr = [1, 2, 3];
array.reverse(arr);
// Result: [3, 2, 1]
```

### 1.2 String Operations (7 functions)

**File:** `src/stdlib/stdlib_string_advanced.c`

```rads
// All functions to implement:

// 1. split - Split string by delimiter
turbo parts = string.split("a,b,c", ",");
// Result: ["a", "b", "c"]

// 2. join - Join array with separator
turbo joined = string.join(["a", "b", "c"], "-");
// Result: "a-b-c"

// 3. trim - Remove leading/trailing whitespace
turbo trimmed = string.trim("  hello  ");
// Result: "hello"

// 4. upper - Convert to uppercase
turbo upper = string.upper("hello");
// Result: "HELLO"

// 5. lower - Convert to lowercase
turbo lower = string.lower("HELLO");
// Result: "hello"

// 6. replace - Replace all occurrences
turbo replaced = string.replace("hello world", "world", "RADS");
// Result: "hello RADS"

// 7. substring - Extract substring
turbo sub = string.substring("hello", 1, 4);
// Result: "ell"
```

### 1.3 Math Extensions (7 functions)

**File:** `src/stdlib/stdlib_math_extended.c`

```rads
// All functions to implement:

// 1. min - Minimum of arguments
turbo minVal = math.min(5, 3, 8, 1);
// Result: 1

// 2. max - Maximum of arguments
turbo maxVal = math.max(5, 3, 8, 1);
// Result: 8

// 3. clamp - Clamp value to range
turbo clamped = math.clamp(150, 0, 100);
// Result: 100

// 4. floor - Round down
turbo floored = math.floor(3.7);
// Result: 3

// 5. ceil - Round up
turbo ceiled = math.ceil(3.2);
// Result: 4

// 6. round - Round to nearest
turbo rounded = math.round(3.5);
// Result: 4

// 7. random - Random number 0-1
turbo rand = math.random();
// Result: 0.xxx (random float)
```

### 1.4 Filesystem Operations (3 functions)

**File:** `src/stdlib/stdlib_filesystem.c`

```rads
// All functions to implement:

// 1. readdir - List directory contents
turbo files = fs.readdir("/tmp");
// Result: ["file1.txt", "file2.txt", "subdir"]

// 2. stat - Get file information
turbo info = fs.stat("/tmp/file.txt");
// Result: {size: 1024, type: "file", modified: 1234567890}

// 3. unlink - Delete file
turbo deleted = fs.unlink("/tmp/old.txt");
// Result: true
```

### 1.5 Async Utilities (4 functions)

**File:** `src/stdlib/stdlib_async_utils.c`

```rads
// All functions to implement:

// 1. parallel - Run functions in parallel
async.parallel([fn1, fn2, fn3]);

// 2. series - Run functions sequentially
async.series([fn1, fn2, fn3]);

// 3. retry - Retry with backoff
async.retry(riskyOperation, 3);  // Retry 3 times

// 4. timeout - Timeout after duration
async.timeout(slowOperation, 1000);  // 1 second timeout
```

---

## ğŸŒŸ PRIORITY 2: Enhanced Core Features (Week 4-5)

### 2.1 Error Handling (try-catch-finally)

**New Tokens:**
- `TOKEN_TRY`
- `TOKEN_CATCH`
- `TOKEN_FINALLY`
- `TOKEN_THROW`

**New AST Nodes:**
- `AST_TRY_STMT`
- `AST_CATCH_CLAUSE`
- `AST_FINALLY_CLAUSE`
- `AST_THROW_STMT`

**Target Syntax:**
```rads
try {
    risky_operation();
} catch (e) {
    echo("Error: " + e.message);
} finally {
    cleanup();
}
```

**Files to Modify:**
- `src/core/lexer.h` / `lexer.c`
- `src/core/ast.h` / `ast.c`
- `src/core/parser.c`
- `src/core/interpreter.c`
- `src/runtime/error_types.c`

### 2.2 Type System Enhancements

**Features:**
- Type annotation parsing
- Type inference for `turbo` variables
- Type checking phase
- Type error messages

**Target Behavior:**
```rads
turbo int x = "hello";  // Error: Type mismatch
turbo arr = [1, 2, 3];
arr.push("string");     // Error: Array<int> expected int
```

**Files to Modify:**
- `src/typecheck/typecheck.c`
- `src/typecheck/optional_types.c`
- `src/typecheck/generics.c`
- `src/typecheck/inference.c`

### 2.3 Import System

**Target Syntax:**
```rads
import "utils.rads";           // Import file
import math from "math.rads";  // Import specific
import * from "std/io.rads";   // Import all
```

**Implementation:**
- Resolve file paths
- Parse imported file
- Merge ASTs
- Handle circular imports

**Files to Modify:**
- `src/core/interpreter.c`
- `src/core/parser.c`

---

## ğŸš€ PRIORITY 3: Performance & Polish (Week 6-7)

### 3.1 Bytecode Optimizations
- Constant folding
- Dead code elimination
- Inline caching
- Loop optimization

### 3.2 Profiler Integration
```bash
rads --profile program.rads
# Outputs: flamegraph.html
```

### 3.3 Warning System
```
Warning: Variable 'x' is declared but never used
Warning: Condition is always true
Warning: Unreachable code after return
```

---

## ğŸ“š PRIORITY 4: Developer Experience (Week 7-8)

### 4.1 Complete LSP Features
- Rename symbol across files
- Find all references
- Code actions
- Better diagnostics

### 4.2 Better Error Messages
```
Error: Undefined variable 'x'
  --> Line 5, Column 8
   5 |     echo(x);
     |          ^
   = help: Did you mean 'xs'? (defined on line 3)
```

### 4.3 Documentation Generator
```bash
rads docs --format html --output docs/
```

---

## ğŸ—“ï¸ 8-Week Timeline

| Week | Focus | Deliverables |
|------|-------|--------------|
| **1** | ğŸ”´ Bug Fixes | Arrays work, returns work, types work |
| **2** | ğŸ“š stdlib Arrays + Strings | All array/string functions implemented |
| **3** | ğŸ“š stdlib Math + FS + Async | All math/fs/async functions implemented |
| **4** | ğŸŒŸ Error Handling | try-catch-finally works |
| **5** | ğŸŒŸ Type System + Imports | Type checking, import system |
| **6** | ğŸš€ Performance | Optimizations, profiler |
| **7** | ğŸ“š LSP + Errors | Complete LSP, better errors |
| **8** | ğŸ§ª Testing + Polish | Full test coverage, release |

---

## ğŸ“‹ Success Criteria

### Must Have for Release âœ…
- [ ] Arrays work 100% - All operations return correct values
- [ ] All stdlib functions implemented - Zero stubs in core modules
- [ ] Type inference works - `typeof` returns correct types
- [ ] Function returns work - Nested functions return properly
- [ ] Try-catch works - Basic exception handling
- [ ] Import works - Can split code into files
- [ ] Zero critical bugs - All tests pass
- [ ] Performance improved - 20%+ faster than v0.0.7

### Nice to Have â­
- [ ] Generics support in types
- [ ] Full LSP code actions
- [ ] Documentation generator
- [ ] Warning system
- [ ] Incremental compilation

---

## ğŸ§ª Test Plan

### New Test Files Required
```
tests/
â”œâ”€â”€ test_arrays.rads          # Array operations
â”œâ”€â”€ test_strings.rads         # String functions
â”œâ”€â”€ test_math.rads            # Math functions
â”œâ”€â”€ test_filesystem.rads      # File I/O
â”œâ”€â”€ test_async.rads           # Async utilities
â”œâ”€â”€ test_try_catch.rads       # Error handling
â”œâ”€â”€ test_imports.rads         # Import system
â”œâ”€â”€ test_types.rads           # Type checking
â””â”€â”€ test_comprehensive.rads   # Full integration
```

### Coverage Goal: 90%+

---

## ğŸ’¡ Deferred to v0.0.9

| Feature | Reason |
|---------|--------|
| LLVM JIT | Too complex, needs solid foundation first |
| WebAssembly | Experimental, not critical |
| Generational GC | Current GC sufficient for now |
| Constellation (distributed) | Advanced feature, needs more core work |
| Package registry | Infrastructure heavy |
| ECMAScript transpiler | Nice to have, not essential |

---

## ğŸ”„ Migration from v0.0.7

**Breaking Changes:** None! v0.0.8 is 100% backward compatible.

**New Dependencies:** None

---

## ğŸ“ Implementation Order

1. **Week 1: Fix Critical Bugs**
   - [ ] Fix array literals returning null
   - [ ] Fix function return values
   - [ ] Fix typeof operator

2. **Week 2: Array + String stdlib**
   - [ ] Implement array.map
   - [ ] Implement array.filter
   - [ ] Implement array.reduce
   - [ ] Implement array.find
   - [ ] Implement array.some
   - [ ] Implement array.every
   - [ ] Implement array.sort
   - [ ] Implement array.reverse
   - [ ] Implement string.split
   - [ ] Implement string.join
   - [ ] Implement string.trim
   - [ ] Implement string.upper
   - [ ] Implement string.lower
   - [ ] Implement string.replace
   - [ ] Implement string.substring

3. **Week 3: Math + FS + Async stdlib**
   - [ ] Implement math.min
   - [ ] Implement math.max
   - [ ] Implement math.clamp
   - [ ] Implement math.floor
   - [ ] Implement math.ceil
   - [ ] Implement math.round
   - [ ] Implement math.random
   - [ ] Implement fs.readdir
   - [ ] Implement fs.stat
   - [ ] Implement fs.unlink
   - [ ] Implement async.parallel
   - [ ] Implement async.series
   - [ ] Implement async.retry
   - [ ] Implement async.timeout

4. **Week 4-5: Core Features**
   - [ ] Add try-catch-finally
   - [ ] Add throw statement
   - [ ] Implement type checking
   - [ ] Implement import system

5. **Week 6-8: Polish**
   - [ ] Performance optimizations
   - [ ] LSP completion
   - [ ] Better error messages
   - [ ] Documentation
   - [ ] Test coverage

---

**Created:** February 17, 2026
**Status:** Ready to Implement
**Next Step:** Begin Priority 0 - Fix Critical Bugs

---

*"From DARK MOON to SUPERNOVA - The explosion begins!"* ğŸ’¥
