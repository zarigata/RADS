# RADS v0.0.3 - Development Progress

**Date Started:** January 10, 2026
**Target Completion:** TBD
**Status:** ğŸš§ IN PROGRESS

---

## ğŸ“‹ Focused Scope for v0.0.3

Based on the full v0.0.3 plan, we're focusing on **high-impact, achievable goals**:

### Priority 1: Critical Fixes ğŸ”´
Fix parser limitations from v0.0.2 that block common patterns.

### Priority 2: Database Support ğŸ—„ï¸
SQLite driver for persistent data storage.

### Priority 3: Testing Framework ğŸ§ª
Built-in testing to ensure quality.

### Priority 4: Async Improvements âš¡
Enhanced async/await based on existing libuv integration.

---

## ğŸ¯ Phase 1: Parser Fixes (Week 1)

### Issues from v0.0.2
1. **Negative number literals** - Cannot use `-42` in expressions
2. **If/else in functions** - Parse errors with conditionals in function bodies
3. **Better error recovery** - Improve synchronization

### Implementation Tasks
- [ ] Fix unary minus operator parsing
- [ ] Fix if/else statement parsing in function contexts
- [ ] Add comprehensive parser tests
- [ ] Document parser grammar

**Success Criteria:**
```rads
blast abs(x) {
    if (x < 0) {
        return -x;  // Negative literal works
    }
    return x;
}

result = math.sqrt(-1);  // Unary minus in call
```

---

## ğŸ—„ï¸ Phase 2: SQLite Database Driver (Week 2-3)

### Core Features
- Connect to SQLite databases
- Execute queries with parameters
- Fetch results as arrays/structs
- Basic transaction support
- Connection management

### API Design
```rads
// Open database
turbo db = db.sqlite_open("app.db");

// Execute query
db.execute("CREATE TABLE users (id INTEGER, name TEXT)");

// Insert with parameters
db.execute("INSERT INTO users VALUES (?, ?)", [1, "Alice"]);

// Query and fetch
turbo users = db.query("SELECT * FROM users WHERE id > ?", [0]);
for (i = 0; i < users.length; i = i + 1) {
    echo("User: " + users[i].name);
}

// Close
db.close();
```

### Implementation Tasks
- [ ] Add SQLite3 library dependency to Makefile
- [ ] Create `src/stdlib/stdlib_db.c`
- [ ] Implement `db.sqlite_open(path)`
- [ ] Implement `db.execute(sql, params?)`
- [ ] Implement `db.query(sql, params?)`
- [ ] Implement `db.close()`
- [ ] Add transaction support (`begin`, `commit`, `rollback`)
- [ ] Create example programs
- [ ] Add error handling for SQL errors

**File:** `src/stdlib/stdlib_db.c`

---

## ğŸ§ª Phase 3: Testing Framework (Week 3-4)

### Core Features
- `test` keyword for test definitions
- Assertion functions (assert, assert_eq, assert_ne, etc.)
- Test runner (`rads test file.rads`)
- Test reporting (pass/fail counts)

### Syntax Design
```rads
test "basic arithmetic" {
    turbo result = 2 + 2;
    assert_eq(result, 4);
}

test "string concatenation" {
    turbo msg = "Hello" + " " + "World";
    assert_eq(msg, "Hello World");
}

test "array operations" {
    turbo arr = [1, 2, 3];
    arr.push(4);
    assert_eq(arr.length, 4);
}
```

### Implementation Tasks
- [ ] Add `test` keyword to lexer
- [ ] Add AST_TEST_DECL node type
- [ ] Parse test declarations
- [ ] Create test registry in interpreter
- [ ] Implement assertion functions:
  - [ ] `assert(condition)`
  - [ ] `assert_eq(actual, expected)`
  - [ ] `assert_ne(actual, expected)`
  - [ ] `assert_true(value)`
  - [ ] `assert_false(value)`
  - [ ] `assert_null(value)`
- [ ] Add `--test` mode to CLI
- [ ] Generate test reports
- [ ] Create example test files

**Files:**
- `src/core/lexer.c` - Add TEST token
- `src/core/ast.h` - Add AST_TEST_DECL
- `src/core/parser.c` - Parse test blocks
- `src/core/interpreter.c` - Test execution
- `src/stdlib/stdlib_test.c` - Assertion functions

---

## âš¡ Phase 4: Async Improvements (Week 4-5)

### Current State
- libuv already integrated
- Basic async operations via stdlib_net

### Enhancements
- Better error handling in async contexts
- Timeout support for async operations
- Async file operations (non-blocking I/O)

### API Extensions
```rads
// Async file read with timeout
turbo content = await fs.read_async("large_file.txt", timeout: 5000);

// Parallel async operations (simple version)
turbo file1 = fs.read_async("file1.txt");
turbo file2 = fs.read_async("file2.txt");
turbo content1 = await file1;
turbo content2 = await file2;
```

### Implementation Tasks
- [ ] Add timeout parameter to async operations
- [ ] Implement async file read/write
- [ ] Add async error propagation
- [ ] Create async examples
- [ ] Document async patterns

---

## ğŸ“¦ Phase 5: Additional Improvements

### Standard Library Additions
- [ ] `string` module expansions:
  - `string.split(str, delimiter)`
  - `string.trim(str)`
  - `string.upper(str)`
  - `string.lower(str)`
  - `string.replace(str, old, new)`

- [ ] `array` module (array utilities):
  - `array.map(arr, callback)`
  - `array.filter(arr, callback)`
  - `array.reduce(arr, callback, initial)`
  - `array.sort(arr)`
  - `array.reverse(arr)`

### Parser Enhancements
- [ ] Switch statement support
- [ ] For-in loops for arrays
- [ ] Break and continue statements
- [ ] Multiple return values / destructuring

---

## ğŸ¯ Success Criteria for v0.0.3

### Must Have âœ…
- [ ] All v0.0.2 parser bugs fixed
- [ ] SQLite driver fully functional
- [ ] Testing framework working with examples
- [ ] At least 3 example apps using new features

### Nice to Have ğŸŒŸ
- [ ] Async file operations
- [ ] String/array utility functions
- [ ] Switch statement
- [ ] Documentation updates

### Deferred to v0.0.4 â­ï¸
- PostgreSQL driver
- MySQL driver
- VM/JIT compilation
- LSP server
- VS Code extension
- Full ORM functionality
- Code coverage

---

## ğŸ“Š Current Progress

### Week 1 Progress
- [x] Created v0.0.3 plan
- [ ] Fixed negative literal parsing
- [ ] Fixed if/else in functions
- [ ] Parser tests created

### Week 2 Progress
- [ ] SQLite integration started
- [ ] Database API designed
- [ ] Basic queries working

### Week 3 Progress
- [ ] Test framework parser support
- [ ] Assertion library implemented
- [ ] Test runner CLI working

---

## ğŸ”¬ Testing Plan

### Test Files to Create
1. `tests/test_parser_fixes.rads` - Verify parser improvements
2. `tests/test_database.rads` - SQLite operations
3. `tests/test_testing.rads` - Meta: test the test framework
4. `tests/test_async.rads` - Async improvements
5. `examples/todo_app.rads` - Full app with SQLite
6. `examples/blog_simple.rads` - Blog with database

---

## ğŸ“ Notes

### Dependencies to Add
- SQLite3 development libraries
- Update Makefile for new stdlib files

### Breaking Changes
None planned - v0.0.3 should be fully backward compatible with v0.0.2.

### Performance Considerations
- SQLite operations should be fast (< 10ms for simple queries)
- Test execution should be instant for small test suites
- No regression in v0.0.2 performance

---

## ğŸš€ Getting Started

### Step 1: Environment Setup
```bash
# Install SQLite3 dev libraries
sudo dnf install sqlite-devel  # Fedora/RHEL
# or
sudo apt install libsqlite3-dev  # Ubuntu/Debian

# Verify
pkg-config --modversion sqlite3
```

### Step 2: Parser Fixes
Start with fixing the known parser issues from v0.0.2.

### Step 3: Database Integration
Add SQLite support to the standard library.

### Step 4: Testing Framework
Build the test framework and write tests for new features.

---

**Status:** Ready to begin Phase 1 - Parser Fixes

*Keep it turbo, keep it radical!* ğŸš€

â€” RADS Development Team
